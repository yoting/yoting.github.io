---
layout: post
title: 设计模式之代理模式
date: 2016-08-09
categories: "Design_Pattern"
tags: design
---

### 代理模式概念

​	在直接访问对象时带来的问题，比如说：要访问的对象在远程的机器上。在面向对象系统中，有些对象由于某些原因（比如对象创建开销很大，或者某些操作需要安全控制，或者需要进程外的访问），直接访问会给使用者或者系统结构带来很多麻烦，我们可以在访问此对象时加上一个对此对象的访问层。

​	所谓代理，是指具有与被代理对象相同的接口的类，客户端必须通过代理与被代理的目标类进行交互，而代理一般在交互的过程中（交互前后），进行某些特定的处理。

### 代理模式结构

![img](https://images2015.cnblogs.com/blog/683744/201609/683744-20160929112107375-1656629935.png)

通过UML图，分析代理模式主要设计的对象角色：

- 抽象对象角色：声明了目标类及代理类对象的共同接口，这样在任何可以使用目标对象的地方都可以使用代理对象。


- 目标对象角色：定义了代理对象所代表的目标对象。


- 代理对象角色：代理对象内部含有目标对象的引用，从而可以在任何时候操作目标对象；代理对象和目标对象具有统一的接口，以便可以再任何时候替代目标对象。代理对象通常在客户端调用传递给目标对象之前或者之后，执行某些操作，而非单纯的将调用传递给目标对象。

### 代理模式实现和运用

​	参见另一篇文章：https://yoting.github.io/java/2015/05/29/java-proxy01/

### 代理模式总结

**优点**

- 协调调用者和被调用者，降低了系统的耦合度
- 代理对象作为客户端和目标对象之间的中介，起到了保护目标对象的作用

**缺点**

- 由于在客户端和真实主题之间增加了代理对象，因此会造成请求的处理速度变慢；

- 实现代理模式需要额外的工作（有些代理模式的实现非常复杂），从而增加了系统实现的复杂度。



**应用场景**

- 当需要为一个对象再不同的地址空间提供局部的代表时，此时的代理模式称为**远程代理**：为一个对象在不同的地址空间提供局部代表。

  > 目的：
  >
  > 1. 隐藏一个对象存在于不同地址空间的事实；
  > 2. 远程机器可能具有更好的计算性能与处理速度，可以快速响应并处理客户端请求。

- 当需要创建开销非常大的对象时 ,此时的代理模式称为**虚拟代理**：通过使用过一个小的对象代理一个大对象。

  > 目的：减少系统的开销。

- 当需要控制对原始对象的访问时 ,此时的代理模式称为**保护代理**：控制目标对象的访问，给不同用户提供不同的访问权限

  >  目的：用来控制对真实对象的访问权限

- 当需要在访问对象时附加额外操作时 ,  此时的代理模式称为**智能引用代理**，额外操作包括耗时操作、计算访问次数等等

  > 目的：在不影响对象类的情况下，在访问对象时进行更多的操作

  ​
